install.packages(c("dplyr", "ggplot2"))
install.packages("Rtools")
write('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', file = "~/.Renviron", append = TRUE)
demo()
write('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', file = "~/.Renviron", append = TRUE)
q()
Sys.which("make")
install.packages("jsonlite", type = "source")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_3.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
install.packages("MASS")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
fit <- fitdistr(sample, densfun = 'exponential')
sample = c(483, 705, 2623, 347, 620, 2719, 1035, 421)
#estymator reczny
cat('Estymator reczny', 1/mean(sample))
library('MASS')
fit <- fitdistr(sample, densfun = 'exponential')
cat('Estymator MASS', fit)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab2/zad2_2.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_3.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
print(df$wzrost[df$bmi >= 20.7 & df$bmi < 26.5])
df$wzrost[df$bmi >= 20.7 & df$bmi < 26.5]
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/zad1_5.R")
dane1.2 <- read.table(file.choose(), header = T)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/WdWS/lab1/lab1.R")
dane1.2 <- read.table(file.choose(), header = T)
head(dane1.2)
hist(dane1.2$Area)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
data
data.nb
data.nb.pred <- predict(data.nb, data)
data.nb.pred
data.nb.pred <- predict(data.nb, data, type = "raw")
data.nb.pred <- predict(data.nb, data, type = "raw")
data.nb.pred
data.nb.pred
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
data.nb.pred
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
data.nb.pred
data.nb.pred$class
data.nb.pred$1
data.nb.pred
xp <- seq(-10, 10, 0.1)
yp <- seq(-10, 10, 0.1)
gr <- expand.grid(x = xp, y = yp)
xp
gr
gr[:10,:]
gr[1:10]
gr[1:10,]
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
pi1
me1
me2
se1
Se1
X1[,1:2]
X1
return(pi1 * dmvnorm(X, m1, S) / (pi1 * dmvnorm(X, m1, S) + pi2 * dmvnorm(X, m2, S)))
f.nb <- function(X, m1, m2, S, pi1, pi2) {
return(pi1 * dmvnorm(X, m1, S) / (pi1 * dmvnorm(X, m1, S) + pi2 * dmvnorm(X, m2, S)))
}
contour(xp, yp, matrix(f.nb(gr, me1, me2, Se1, Se2, pi1, pi2), length(xp)), add = T, levels = 0.5, lwd = 2, lty = 2, col = "blue")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
f.nb <- function(X, m1, m2, S1, S2, pi1, pi2) {
return(pi1 * dmvnorm(X, m1, S1) / (pi1 * dmvnorm(X, m1, S1) + pi2 * dmvnorm(X, m2, S2)))
}
contour(xp, yp, matrix(f.nb(gr, me1, me2, Se1, Se2, pi1, pi2), length(xp)), add = T, levels = 0.5, lwd = 2, lty = 2, col = "blue")
X1
m1x = mean(X1$x)
m1x
?dnorm
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
contour(xp, yp, matrix(f.nb(gr, m1x, m1y, m2x, m2y, sd1x, sd1y, sd2x, sd2y, pi1, pi2), length(xp)), add = T, levels = 0.5, lwd = 2, lty = 2, col = "blue")
gr
gr[,1]
X[,2]
gr[,2]
return(pi1 * dnorm(X[,1], m1x, sd1x) * dnorm(X[,2], m1y, sd1y) / (pi1 * dnorm(X[,1], m1x, sd1x) * dnorm(X[,2], m1y, sd1y) + pi2 * dnorm(X[,1], m2x, sd2x) * dnorm(X[,2], m2y, sd2y)))
f.nb <- function(X, m1x, m1y, m2x, m2y, sd1x, sd1y, sd2x, sd2y, pi1, pi2) {
return(pi1 * dnorm(X[,1], m1x, sd1x) * dnorm(X[,2], m1y, sd1y) / (pi1 * dnorm(X[,1], m1x, sd1x) * dnorm(X[,2], m1y, sd1y) + pi2 * dnorm(X[,1], m2x, sd2x) * dnorm(X[,2], m2y, sd2y)))
}
contour(xp, yp, matrix(f.nb(gr, m1x, m1y, m2x, m2y, sd1x, sd1y, sd2x, sd2y, pi1, pi2), length(xp)), add = T, levels = 0.5, lwd = 2, lty = 2, col = "blue")
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab2/zad1_BW.R", echo=TRUE)
me1
m1x
m1y
Se1
sd1x
sd1x * sd1x
sd1y * sd1y
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
CM
CM[0]
CM
CM[1]
CM[1,1]
CM[2,2]
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
TP
TN
acc.vec
lines(TP, k.vec)
points(TP, k.vec)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
Tp
TP
plot(k.vec, acc.vec, xlab = 'knn')
plot(k.vec, acc.vec, xlab = 'k')
plot(k.vec, acc.vec, xlab = 'k', ylab = '')
plot(k.vec, acc.vec, xlab = 'k', ylab = '', main = 'Zależność ACC/TPR/TNR od wartości k')
plot(k.vec, acc.vec, xlab = 'k', ylab = '', main = 'Zależność ACC/TPR/TNR od wartości ilości NN')
points(TP/n1, k.vec)
points(k.vec, TP/n1)
plot(k.vec, acc.vec, xlab = 'k', ylab = '', main = 'Zależność ACC/TPR/TNR od wartości ilości NN', col= 'black')
plot(k.vec, acc.vec, xlab = 'k', ylab = '', main = 'Zależność ACC/TPR/TNR od wartości ilości NN', col= 'black', pch=19)
points(k.vec, TP/n1, col= 'blue', pch=19)
points(k.vec, TN/n2, col= 'red', pch=19)
par(mfrow=c(3,1))
plot(k.vec, acc.vec, xlab = 'k', ylab = '', main = 'Zależność ACC/TPR/TNR od wartości ilości NN', col= 'black', pch=19)
points(k.vec, TP/n1, col= 'blue', pch=19)
points(k.vec, TN/n2, col= 'red', pch=19)
par(mfrow=c(3,1))
plot(k.vec, acc.vec, xlab = 'k', ylab = '', main = 'Zależność ACC/TPR/TNR od wartości ilości NN', col= 'black', pch=19)
plot(k.vec, TP/n1, col= 'blue', pch=19)
plot(k.vec, TN/n2, col= 'red', pch=19)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
acc.total <- c()
TP.total <- c()
TN.total <- c()
Tp
TP
TP.total
TP.total + TP
2 + 3
acc.total <- rep(0, 21)
acc.total
acc.total <- rep(0, 21)
TP.total <- rep(0, 21)
TN.total <- rep(0, 21)
TP.total
TP.total + TP
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
acc.total
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
source("C:/Users/bogum/Desktop/mgr_studia/semestr2/SDE/lab4/zad3_BW.R", echo=TRUE)
setwd("C:/Users/bogum/Downloads")
setwd("C:/Users/bogum/Downloads")
setwd("C:/Users/bogum/Desktop/mgr_studia/semestr2/SED/lab4")
library(MASS)
library(mvtnorm)
library(pROC)
install.packages("pROC")
library(pROC)
library(caret)
install.packages("caret")
library(caret)
x
draw.data.gauss <- function(S1, S2, m1, m2, n1, n2) {
X1 <- mvrnorm(n1, m1, S1)
X2 <- mvrnorm(n2, m2, S2)
X1 <- data.frame(X1); colnames(X1) <- c("x", "y")
X2 <- data.frame(X2); colnames(X2) <- c("x", "y")
X1$class <- "A"; X2$class <- "B"
data <- rbind(X1, X2); data$class <- factor(data$class)
return(data)
}
plot.data <- function(data) {
cols <- c("blue", "orange")
plot(data[,1:2], col = cols[data$class], cex = 2, tcl = .25)
text(data[,1:2], labels = 1:nrow(data), cex = 0.6)
}
S1 <- matrix(c(4, 2, 2, 4), 2, 2)
S2 <- matrix(c(4, 2, 2, 2), 2, 2)
m1 <- c(-1, -1)
m2 <- c(2, 2)
n1 <- 30
n2 <- 20
# Generowanie obserwacji
data <- draw.data.gauss(S1, S2, m1, m2, n1, n2)
plot.data(data)
input <- createDataPartition(data$class, p = 0.6, list = F)
input
data.train
data.train <- data[input,]
data.test <- data[-input,]
data.train
data.test
plot.data(data)
points(data.train[,1:2], cex = 4, pch = 22)
points(data.test[,1:2], cex = 4, pch = 23)
table(data.train$class) / sum(table(data.train$class))
table(data.train$class)
table(data.test$class) / sum(table(data.train$class))
table(data.test$class) / sum(table(data.test$class))
createDataPartition(data$class, p = 0.2, times = 5)
input2 <- createDataPartition(data$class, p = 0.2, times = 5)
input2[0]
input2[0,]
input2$Resample1
fit <- trainControl(method = "none", classProbs = TRUE)
fit
model <- train(class ~ ., data = data.train,
method = "lda", trControl = fit)
model
model
predict(model, data.test)
predict(model, data.test, type = "prob")
fit <- trainControl(method = "cv", number = 10)
model <- train(class ~ ., data = data,
method = "lda", trControl = fit)
model
model <- train(class ~ ., data = data,
method = "lda", trControl = fit)
model
model$modelInfo
model$coefnames
model
grid <- expand.grid(k = 2:30)
grid
plot(grid)
model <- train(class ~ ., data = data,
method = "knn", trControl = fit,
tuneGrid = grid)
model
plot(model)
model1 <- train(class ~ ., data = data, method = "lda", trControl = fit)
model2 <- train(class ~ ., data = data, method = "qda", trControl = fit)
model3 <- train(class ~ ., data = data, method = "nb", trControl = fit)
model4 <- train(class ~ ., data = data, method = "knn", trControl = fit, tuneGrid = grid)
res <- resamples(list(LDA = model1, QDA = model2, NB = model3, KNN = model4))
bwplot(res)
model4
model3
dotplot(res)
CM.values <- function(org.class, pred.posterior, threshold) {
pred.class <- factor(ifelse(pred.posterior >= threshold, 2, 1))
TP <- sum(pred.class == 2 & org.class == "B")
TN <- sum(pred.class == 1 & org.class == "A")
sum.neg <- sum(org.class == "A")
sum.pos <- sum(org.class == "B")
TPR <- TP / sum.pos
FPR <- 1 - TN / sum.neg
return(c(FPR,TPR))
}
get.roc.values <- function(class, posterior) {
progi <- c(-Inf, sort(unique(posterior)), +Inf)
z <- t(sapply(1:length(progi), function(i) CM.values(class, posterior, progi[i])))
return(z)
}
model1.pred <- predict(model1, data, type = "prob")
plot.roc(data$class, model1.pred$A)
roc.own <- get.roc.values(data$class, model1.pred$A)
points(roc.own[,1], 1 - roc.own[,2], col = "red")
roc.own
1 - roc.own[,2]
plot.roc(data$class, model1.pred$A, percent = T, ci = TRUE, of="thresholds", thresholds="best", print.thres="best", print.auc = TRUE)
featurePlot(x = data[,1:2], y = data$class, plot = "density", pch = "|", auto.key = list(columns = 2))
plot.roc(data$class, data$x, percent = T, col = "red")
lines.roc(data$class, data$y, percent = T, col = "blue")
legend("bottomright", legend=c("x", "y"), col=c("red", "blue"), lwd=2)
